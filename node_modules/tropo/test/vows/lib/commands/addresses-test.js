

var assert = require('assert'),
    nock = require('nock'),
    path = require('path'),
    vows = require('vows');
	

var common = require('../common');
var cli = common.cli;

var conf = cli.config;
conf.stores.file.file = path.join(__dirname, '..', '..', 'resources', 'dummy-tropoconf');
conf.stores.file.loadSync();

var prompt = cli.prompt;

var dummyHost = 'http://api.example.com';
var basePath = '/repo';

var makeTopic = common.makeTopic;
var makeTest = common.makeTest;

vows.describe('lib/commands/addresses').addBatch({
    'add works' : makeTest({
        argv : ['addresses','add'],
        setup : function() {
            prompt.override.value = 'foo';
            prompt.override.cloud = 'foo';
            
            var payload = {entity : {                    
                value : prompt.override.value
            }, links : [{name:'cloud',
                uri : prompt.override.cloud}
            ]};
            nock(dummyHost)
                .post(basePath + '/addresses',JSON.stringify(payload)).reply(200, { 

                });
            
        }
    })
}).export(module, { error : false });
