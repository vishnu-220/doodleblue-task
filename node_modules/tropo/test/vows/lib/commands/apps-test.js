

var assert = require('assert'),
    cli = require('../../../../lib/cli'),
    nock = require('nock'),
    path = require('path'),
    vows = require('vows');
	
var conf = cli.config;
conf.stores.file.file = path.join(__dirname, '..', '..', 'resources', 'dummy-tropoconf');
conf.stores.file.loadSync();

var common = require('../common');

var dummyHost = 'http://api.example.com';
var basePath = '/repo';

var makeTopic = common.makeTopic;
var makeTest = common.makeTest;

vows.describe('lib/commands/apps').addBatch({
    'list' : makeTest({
        argv : ['apps','list'],
        setup : function() {
            nock(dummyHost)
                .get(basePath + '/revisions')
                .reply(200, { 
                    results : [{ entity: {
                        id : 1,
                        name : 'fooapp'
                    }},{ entity: {
                        id : 2,
                        name : 'fooapp 2'
                    }}]
                });
        }
    })
}).export(module);
