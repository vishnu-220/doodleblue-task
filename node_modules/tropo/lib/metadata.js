var fs = require('fs');


function load(create) {
    var pkgPath = process.cwd() + '/package.json';
    var exists = fs.existsSync(pkgPath);

    var result = {};
    result.package = {};
    if (exists) {
        var contents = fs.readFileSync(pkgPath);
        result.package = JSON.parse(contents);
    } else if (create) {
        fs.writeFileSync(pkgPath, JSON.stringify(result.package));
    } else {
    	return undefined;
    }
    
    result.package.save = function () {
        var contents = JSON.stringify(result.package, null, "  ");
        fs.writeFileSync(pkgPath, contents);
    };

    result.save = function () {
        result.package.save();
    };

    return result;
}

module.exports.load = load;